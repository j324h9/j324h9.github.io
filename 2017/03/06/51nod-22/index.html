<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  <%
  var title = page.title;

  if (is_archive()){
    title = __('archive_a');

    if (is_month()){
      title += ': ' + page.year + '/' + page.month;
    } else if (is_year()){
      title += ': ' + page.year;
    }
  } else if (is_category()){
    title = __('category') + ': ' + page.category;
  } else if (is_tag()){
    title = __('tag') + ': ' + page.tag;
  }
  %>
  <title><% if (title){ %><%= title %> | <% } %><%= config.title %></title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<!--
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
    });
  </script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
-->
  <%- open_graph({twitter_id: theme.twitter, google_plus: theme.google_plus, fb_admins: theme.fb_admins, fb_app_id: theme.fb_app_id}) %>
  <% if (theme.rss){ %>
    <link rel="alternate" href="<%- theme.rss %>" title="<%= config.title %>" type="application/atom+xml">
  <% } %>
  <% if (theme.favicon){ %>
    <link rel="icon" href="<%- theme.favicon %>">
  <% } %>
  <% if (config.highlight.enable){ %>
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <% } %>
  <%- css('css/style') %>
  <%- partial('google-analytics') %><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">oi_loser&#39;s blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-51nod-22" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/51nod-22/" class="article-date">
  <time datetime="2017-03-06T01:57:03.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      51nod算法马拉松22
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>又一次RP爆发卡线rank 10……有点爽……</p>
<hr>
<p>由于周五是我出的校内训练，所以等21:30讲完题回家路上才开始看题。</p>
<p>路上用手机看题。A题看完以后想到FJOI2016一试T3，其实就是Codechef原题FRBSUM。看起来很复杂，其实注意到一个核心性质：把 <span class="math inline">\(S\)</span> 中的元素排序得到 <span class="math inline">\(a_1\le a_2\le\cdots\le a_n\)</span> 以后，最小的满足 <span class="math inline">\(a_i &gt; 1+\sum_{j=1}^{i-1}a_j\)</span> 的 <span class="math inline">\(i\)</span> 对应的 <span class="math inline">\(\sum_{j=1}^{i-1}a_j\)</span> 就是 <span class="math inline">\(S\)</span> 的优美值。</p>
<p>因为当 <span class="math inline">\(0 &lt; i&#39; &lt; i\)</span> 时，如果 <span class="math inline">\(\{a_1,\cdots,a_{i&#39;-1}\}\)</span> 能配出的数为 <span class="math inline">\([0,\sum_{j=1}^{i&#39;-1}a_j]\)</span>，那么 <span class="math inline">\(\{a_1,\cdots,a_{i&#39;}\}\)</span> 就能配出 <span class="math inline">\([0,\sum_{j=1}^{i&#39;-1}a_j]\cup[a_{i&#39;},\sum_{j=1}^{i&#39;}a_j]=[0,\sum_{j=1}^{i&#39;}a_j]\)</span>。而<strong>由于 <span class="math inline">\(a_i\)</span> 已排序</strong>，所以 <span class="math inline">\(a_{i&#39;} &gt; 1+\sum_{j=1}^{i-1}(i&#39;\ge i)\)</span>，因此 <span class="math inline">\(1+\sum_{j=1}^{i-1}\)</span> 配不出来。这样求优美值就很简单了：排序以后，一开始 <span class="math inline">\(\mathrm{sum}=0\)</span>，从小到大把 <span class="math inline">\(a_i\)</span> 加入 <span class="math inline">\(\mathrm{sum}\)</span>，一旦加入前发现 <span class="math inline">\(a_i\not\in[0,1+\mathrm{sum}]\)</span> 就得到答案了。<em>（FJOI原题是多次询问区间答案，做法是用可持久化线段树加速查询 <span class="math inline">\([0,\mathrm{sum}+1]\)</span> 区间内的数，因为一次可以把多个数加进 <span class="math inline">\(\mathrm{sum}\)</span>，所以 <span class="math inline">\(\mathrm{sum}\)</span> 只会增加 <span class="math inline">\(O(\log\sum a_i)\)</span> 次）</em></p>
<p>想到这里，这题差不多就会做了，从小到大选 <span class="math inline">\(S_1\)</span> 中的元素，如果 <span class="math inline">\(S_1\)</span> 中没有 <span class="math inline">\([0,\mathrm{sum}+1]\)</span> 内的元素（<span class="math inline">\(\mathrm{sum}\)</span> 为已选元素之和），那么就从 <span class="math inline">\(S_2\)</span> 中贪心选出尽量大的数加入 <span class="math inline">\(S_3\)</span>（因为答案是选出数的和，所以不贪心取最大的话可以调整成更大的数更优），直到 <span class="math inline">\(S_1\)</span> 和 <span class="math inline">\(S_2\)</span> 剩下元素都大于 <span class="math inline">\(1+\mathrm{sum}\)</span> 或 <span class="math inline">\(|S_3|=k\)</span>。于是我直接在手机上写完，交上去，TLE。</p>
<p>然而我的复杂度是 <span class="math inline">\(O(nm\log m+Tm)\)</span> 啊，应该不会TLE的？回头看一遍数据范围发现这题输入了 <span class="math inline">\(10^6\)</span> 个数，不加输入优化没什么救，然后就在刚到家的时候把输入优化码完，AC了。</p>
<p>回家上电脑接着看了后几题。B题一开始以为是个无聊的卡精度马尔可夫过程，思考了一下才明白决策是自己选的，然后列出来就是最小化一个带一堆 <span class="math inline">\(\min\)</span> 的奇怪式子，不会了。C题题目不是很懂，一大堆 <span class="math inline">\(e\)</span> 看起来很丧。D题让我想到了UOJ #176，然而这题我并不会做，惨啊……</p>
<p>不过好像D可做？用UOJ那题的题解里提到的Boruvka算法，建Trie维护一下可能就OK了？问题是要计数。接着想了一些办法，首先是相同点权构成的点集 <span class="math inline">\(S\)</span> 连的是边权 <span class="math inline">\(0\)</span> 的完全图，一定全部被连起来，方案数是 <span class="math inline">\(|S|^{|S|-2}\)</span>。缩完相同点权以后，相同边权的边就没有公共点了，意味着MST唯一？好像很资磁。</p>
<p>于是快要0:00开始写Boruvka，写完一测样例果然萎了。原来……我太SB了，虽然相同边权的边没有公共点但是在缩的时候会把这些边的端点缩到一块去……看样子这么做下去并没有前途。</p>
<p>先去睡觉了。</p>
<p>纠结于5题刚不出来的我冷静了一晚上，感觉好像理解了C题的意思。于是第二天一起来去刚C题。</p>
<p>推了一发式子——</p>
<p><span class="math display">\[[f(x)-e^x]^2=\sum_{i=0}^Na_i^2x^{2i}+2\sum_{i=0}^{N-1}\sum_{j=i+1}^Na_ia_jx^{i+j}-2\sum_{i=0}^Na_ix^ie^x\]</span></p>
<p><span class="math display">\[(x^i)&#39;=ix^{i-1}\Rightarrow\int_0^1x^i\mathrm{d}x=\frac{1}{i+1}1^{i+1}-\frac{1}{i+1}0^{i+1}=\frac{1}{i+1}\]</span></p>
<p>然后并没有想清楚 <span class="math inline">\(x^ie^x\)</span> 定积分怎么求，就开始手算小数据：</p>
<p><span class="math display">\[(x^ie^x)&#39;=(ix^{i-1}+x^i)e^x\]</span></p>
<p><span class="math display">\[\Rightarrow [(x-1)e^x]&#39;=xe^x\]</span></p>
<p><span class="math display">\[\Rightarrow [(x^2-2x+2)e^x]&#39;=x^2e^x\]</span></p>
<p><span class="math display">\[\Rightarrow [(x^3-3x^2+6x-6)e^x]&#39;=x^3e^x\]</span></p>
<p>这样归纳一下好像就推出来了：</p>
<p><span class="math display">\[(e^x\sum_{i=0}^n(-1)^iA_n^ix^{n-i})&#39;=x^ne^x\Rightarrow\int_0^1x^ne^x\mathrm{d}x=e\sum_{i=0}^n(-1)^iA_n^i-(-1)^nn!\]</span></p>
<p>这么看来原式应该就等于</p>
<p><span class="math display">\[\sum_{i=0}^N\frac{1}{2i+1}a_i^2+2\sum_{i=0}^{N-1}\sum_{j=i+1}^N\frac{1}{i+j+1}a_ia_j-2\sum_{i=0}^N[e\sum_{j=0}^i(-1)^jA_i^j-(-1)^ii!]a_i\]</span></p>
<p>只有二次诶，那只要对每个 <span class="math inline">\(a_i\)</span> 令偏导为 <span class="math inline">\(0\)</span> 就行了，就能得到一个 <span class="math inline">\(N+1\)</span> 元一次方程组（<strong>UPD</strong>）：</p>
<p><span class="math display">\[\frac{2}{2i+1}a_i+2\sum_{0\le j\le N,j\ne i}\frac{1}{i+j+1}a_j-2[e\sum_{j=0}^i(-1)^jA_i^j-(-1)^ii!]=0\]</span></p>
<p>用高斯消元解方程组就做完了，可是 <span class="math inline">\(a_i=\sum_{j=0}^\infty p_{ij}\cdot e^j\)</span> 什么鬼？？难道要把多项式放进去消元，这个是要炸的呀。看了下方程组发现系数矩阵 <span class="math inline">\(A\)</span> 的数都是有理数，那么解方程 <span class="math inline">\(Ax=b\)</span>（<span class="math inline">\(x,b\)</span> 为列向量）得到 <span class="math inline">\(x=A^{-1}b\)</span>，而 <span class="math inline">\(b\)</span> 中的数都能表示成 <span class="math inline">\(p_0+p_1e\)</span> 的形式，所以答案 <span class="math inline">\(x\)</span> 也能表示成 <span class="math inline">\(p_0+p_1e\)</span> 的形式。</p>
<p>出题人真坑，明明答案是 <span class="math inline">\(p_0+p_1\)</span> 的形式，只有 <span class="math inline">\(p_{i0},p_{i1}\)</span> 是有用的，题面偏要写成 <span class="math inline">\(\sum_{j=0}^\infty p_{ij}\)</span> 误导别人存整个多项式。然后又只要输出有用的那两个数。坑爹！！</p>
<p>推导这里就开始写，写完之后测了下样例 <span class="math inline">\(N=0\)</span> 过了，<span class="math inline">\(N=1\)</span> 的WA了。开始怀疑算法有没错。或者是哪一步推导错了。好虚啊。</p>
<p>手算了一边发现算法是对的，调一发程序，是程序把某个式子算错了= =b</p>
<p>改改改。</p>
<p>终于过样例了。</p>
<p>终于过了C。</p>
<p>看了下榜已经一堆人过5题了，而我只有约四十名。我开始做B题。</p>
<p>一开始想枚举每个点的前继然后怎么搞，觉得好像有反例（？）就犹豫了好长时间。不过想了一会儿还是找到了正确的思路：先确定 <span class="math inline">\(0\)</span> 个星的时候的决策，显然升级概率越大越好，再确定 <span class="math inline">\(1\)</span> 个星时候的决策……</p>
<p>因此，记 <span class="math inline">\(f_i\)</span> 为当前有 <span class="math inline">\(i\)</span> 个星，按照最优策略，第一次变成 <span class="math inline">\(i+1\)</span> 星的期望花费，则枚举选择的魔法石 <span class="math inline">\(j\)</span>，有 <span class="math inline">\(1-\mathrm{prob}(i,j)\)</span> 概率失败，失败的话就要从 <span class="math inline">\(i-\mathrm{lose}(i,j)\)</span> 星逐步转移到 <span class="math inline">\(i+1\)</span> 星，因此 <span class="math inline">\(f_i=\min_j\{C_j+[ 1 - \mathrm{prob}(i,j) ]\sum_{k=i-\mathrm{lose}(i,j)}^if_k\}\)</span>。</p>
<p>移项得到 <span class="math inline">\(f_i=\min_j\{\frac{C_j}{\mathrm{prob}(i,j)}+[\frac{1}{\mathrm{prob}(i,j)}-1]\sum_{k=i-\mathrm{lose}(i,j)}^{i-1}f_k\}\)</span>。直接DP会有精度问题吗？</p>
<p>那我写一下交个看看。写完没过样例因为我把 <span class="math inline">\(C_i\)</span> 写丢了（还查了好一会儿），过了样例交上去。结果，居然直接AC了，完全没有卡精度的迹象。</p>
<p>我也不知道为什么没有出精度问题，也许是运气好吧。上次在51nod做同一个出题人出的马尔可夫过程题还卡了好久的精度呢。</p>
<p>再看D的时候D的通过人数已经好多了。这题一定不难，只是我想复杂了。</p>
<p>于是手工模拟了一遍点集 <span class="math inline">\(\{0,1,2,3,4,5,6,7,8\}\)</span> 的Kruskal过程，整个过程如下：</p>
<p><span class="math display">\[\{0\},\{1\},\{2\},\{3\},\{4\},\{5\},\{6\},\{7\}\]</span></p>
<p><span class="math display">\[\{0,1\},\{2,3\},\{4,5\},\{6,7\}\]</span></p>
<p><span class="math display">\[\{0,1,2,3\},\{4,5,6,7\}\]</span></p>
<p><span class="math display">\[\{0,1,2,3,4,5,6,7\}\]</span></p>
<p>我好像发现了什么……是按二进制位从低到高合并的！</p>
<p>如果在Trie树上呢？连边 <span class="math inline">\((u,v)\)</span> 的时候，<span class="math inline">\((u,v)\)</span> 的权值最高位就是 <span class="math inline">\(u,v\)</span> 在Trie上的LCA高度。因此对Trie树 <span class="math inline">\(T\)</span> 模拟Kruskal的方法是这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Kruskal(T):</span><br><span class="line">	若 T 的左子树非空: Kruskal(T 的左子树)</span><br><span class="line">	若 T 的右子树非空: Kruskal(T 的右子树)</span><br><span class="line">	// 以上两步之后最多只剩左右子树两个连通块，并且这两步过程中连的边权都比剩下可能连的边小，因此是正确的</span><br><span class="line">	若 T 的左子树 T1 和右子树 T2 均非空（假设 |T1| &lt; |T2|）:</span><br><span class="line">		x = Infinity, c = 0</span><br><span class="line">		DFS 枚举 T1 节点 u，DFS 过程中在 T2 中贪心地找点 v 使得 a[u] xor a[v] 最小: // 由于缩了相同点，每个 u 对应的 v 唯一</span><br><span class="line">			若 a[u] xor a[v] = x: c += 1</span><br><span class="line">			若 a[u] xor a[v] &lt; x: x = a[u] xor a[v], c = 1</span><br><span class="line">	最小生成树边权和加 x，方案数乘 c</span><br></pre></td></tr></table></figure>
<p>这个问题的性质就是左右子树独立，注意到这一点以后就变地简单多了。然后我把原来写的错误的Trie树Boruvka算法删了一大半，改成直接在树上DFS，过了样例，交上去也过了。</p>
<p>过D的时候12:00多。昨晚觉得B、C、D都一副不可做的样子，不过现在都做出来了，有点爽。</p>
<p>还剩E、F两题。</p>
<p>下午开始搞E。有点像个大代码数据结构题，不过如果真是这样的话不虚，因为时间充足，呵呵。</p>
<p>一开始题目看错了，以为是链上插入一个元素，查询过一个点的元素中前 <span class="math inline">\(k\)</span> 小的异或。我想这不就是把链拆成到根的路径以后转成查子树区间 <span class="math inline">\(k\)</span> 小吗，可持久化线段树就搞定了。E题肯定不是这么简单！又读了遍题目，才明白真正的题目意思是：每个点 <span class="math inline">\(i\)</span> 维护一个初值为 <span class="math inline">\(0\)</span> 的数组 <span class="math inline">\(c_i\)</span>，每个操作 <span class="math inline">\((u,v,a,b)\)</span> 把链 <span class="math inline">\((u,v)\)</span> 上所有点 <span class="math inline">\(i\)</span> 的 <span class="math inline">\(c_i[b]\)</span> 增加 <span class="math inline">\(a\)</span>，查询的是 <span class="math inline">\(c_w\)</span> 数组中 <span class="math inline">\(c_w[i]\)</span> 前 <span class="math inline">\(k\)</span> 小的 <span class="math inline">\(i\)</span> 的异或。</p>
<p>这下就不太一样了，因为用可持久化线段树虽然可以对每个 <span class="math inline">\(b\)</span> 查出 <span class="math inline">\(c_w[b]\)</span>，却不能查出 <span class="math inline">\(c_w[b]\)</span> 前 <span class="math inline">\(k\)</span> 大的 <span class="math inline">\(b\)</span>。不给力。</p>
<p>可能我需要换个想法。如果不是树而是序列呢？那就只要按顺序扫一遍过去，维护一个 <span class="math inline">\(c\)</span> 数组，遇到操作的左端点就把 <span class="math inline">\(c[b]\)</span> 加 <span class="math inline">\(a\)</span>，遇到右端点就 <span class="math inline">\(c[b]\)</span> 减 <span class="math inline">\(a\)</span>。用线段树维护每个 <span class="math inline">\(x\)</span> 对应的满足 <span class="math inline">\(c[i]=x\)</span> 的 <span class="math inline">\(i\)</span> 个数就能查前 <span class="math inline">\(k\)</span> 小了。可是一样多的按 <span class="math inline">\(i\)</span> 排序怎么搞？</p>
<p>那就把每个 <span class="math inline">\((c[i],i)\)</span> 表示成一个数 <span class="math inline">\(c[i]\cdot B+i\)</span>。</p>
<p>值域好像很大的样子，线段树要动态开节点- -那么如果是树呢？树剖一下？</p>
<p>于是一个操作被拆成了 <span class="math inline">\(O(\log n)\)</span> 个，每次要改线段树，复杂度变成 <span class="math inline">\(O(\log^2 n)\)</span> 了- -</p>
<p>不知道能不能过，而且觉得空间会爆炸的样子。不过空间好像不是 <span class="math inline">\(O(m\log^2 n)\)</span> 而是 <span class="math inline">\(O(m\log n)\)</span>？我写下。……写完了，调一发。……过样例了。</p>
<p>然后在51nod上运行了第一个点，MLE。</p>
<p>数组改小。</p>
<p>MLE。</p>
<p>再改小。</p>
<p>MLE。</p>
<p>再改小。</p>
<p>RE。</p>
<p>想放弃。</p>
<p>然后记起51nod好像是64位机？如果我把指针改成 <code>int</code> 下标呢？改。</p>
<p>改完。</p>
<p>测一下。</p>
<p>第一个点过了。</p>
<p>交。</p>
<p>WA</p>
<p>WA</p>
<p>WA</p>
<p>……</p>
<p>那应该是我写挂了。回去和暴力拍小数据，怎么都拍不WA，又拍了好多组大数据也拍不WA。这就很尴尬了QAQ</p>
<p>最后还是死于线段树的区间：<code>right = m * 10000000000ll</code> 打成了 <code>right = 10000000000ll</code>。这个小数据不太可能拍出来……</p>
<p>挣扎了一下午，终于在17:00前用两个 <span class="math inline">\(\log\)</span> 把这题卡过去了。</p>
<p>有希望。</p>
<p>现在剩下F。</p>
<p>所有LCS的和？我只会求 <span class="math inline">\(|s_2|\)</span> 遍LCS。可是显然过不去。</p>
<p>或者是需要一些特殊的状态设计？于是开始设计新的DP，结果不管怎么改都要 <span class="math inline">\(O(|s_1||s_2|^2)\)</span>。GG。总觉得自己是想复杂掉坑了，可是又总是找不到可行的方法。</p>
<p>最后还是在rank 1的AKF帮助下才得救……AKF表示这题是“All Substring LCS”，是论文题。于是我就去看了论文，然而由于我太菜鸡了，看了很久才看懂。。。</p>
<p>所以到了第二天的下午才搞掉F。一看排行榜，刚好rank 10。有点感动。</p>
<hr>
<p>这场比赛还是有一些收获的。</p>
<p>A题的贪心算法还是比较妙的，虽然如果做过Codechef原题以后就没什么难度了- -</p>
<p>B题给我的启发是：形如 <span class="math inline">\(f(i)=a_i+\sum_{j=0}^{i+1}c_{i,j}f(j)\)</span>（其中 <span class="math inline">\(\sum_{j=0}^{i+1}c_{i,j}=1,c_{i,i}\ne 1\)</span>）这样的方程，可以按照 <span class="math inline">\(i=0,1,2,\cdots\)</span> 的顺序递推，这样的好处是，每个 <span class="math inline">\(f(i)\)</span> 可以表示为 <span class="math inline">\(f(i+1)+p_i\)</span> 的形式，可以归纳证明：</p>
<p><span class="math display">\[f(i)=a_i+\sum_{j=0}^{i-1}c_{i,j}[f(i)+\sum_{k=j}^{i-1}p_k]+c_{i,i}f(i)+c_{i,i+1}f(i+1)\]</span></p>
<p><span class="math display">\[\Rightarrow f(i)=a_i+(1-c_{i,i+1})f(i)+\sum_{j=0}^{i-1}\sum_{k=j}^{i-1}p_k+c_{i,i+1}f(i+1)\]</span></p>
<p><span class="math display">\[\Rightarrow f(i)=\frac{1}{c_{i,i+1}}(a_i+\sum_{j=0}^{i-1}\sum_{k=j}^{i-1}p_k)+f(i+1)\]</span></p>
<p>即 <span class="math inline">\(p_i=\frac{1}{c_{i,i+1}}(a_i+\sum_{j=0}^{i-1}\sum_{k=j}^{i-1}p_k)\)</span>，若已知 <span class="math inline">\(f(n)=0\)</span>，按 <span class="math inline">\(i=0,1,2,\cdots,n-1\)</span> 顺序递推 <span class="math inline">\(p_i\)</span> 可以求出所有的 <span class="math inline">\(f(i)\)</span>。另外我还是很好奇这题为什么要注意精度，直接写应该就过了吧？</p>
<p>C题的收获是求 <span class="math inline">\(x^ie^x\)</span> 的积分以及用偏导求多元二次函数的最值（其实原理和初中学的二次函数一模一样）<del>以及克服看到一大坨数学公式时的畏难情绪</del>。</p>
<p>D题的思路很不错，也是<strong>容易想错</strong>的题，主要是容易往基尔霍夫矩阵等复杂算法考虑，却解决不了。<strong>能深入理解Kruskal这一个算法，比涉猎各种复杂的图论算法（如基尔霍夫矩阵等）有意义得多。</strong></p>
<p>E题后来immortalCO给我讲了一个更简单的做法：按照我之前的想法拆链之后，不用可持久化线段树前缀和来查询，而是对每个节点维护子树的 <span class="math inline">\(c\)</span> 数组以及对应的排序列表，用平衡树启发式合并来维护。这样虽然时间也是 <span class="math inline">\(O(n\log^2n)\)</span> 的，但空间是 <span class="math inline">\(O(n)\)</span> 的，不需要强行优化内存常数。想想我去年做一道Codechef的启发式合并题想了好几天才想到正解。可见我还需要加强数据结构的灵活变通能力。</p>
<p>F题的收获是学习了一个新的算法ALCS，这个算法思想是很不错的，利用特殊的单调性来改变状态设计。希望能找到这类问题的更多应用。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/03/06/51nod-22/" data-id="cjeh7615t0000gy1l84izkofr" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/51nod/">51nod</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/酱油记/">酱油记</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/04/03/51nod-23/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          51nod算法马拉松23
        
      </div>
    </a>
  
  
    <a href="/2017/02/24/thutrain2016-record/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">清华集训2016订正记录（待更新）</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/51nod/">51nod</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/APIO/">APIO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AtCoder/">AtCoder</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTSC/">CTSC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Codechef/">Codechef</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Codeforces/">Codeforces</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FJOI/">FJOI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FJWC/">FJWC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HNOI/">HNOI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IOI/">IOI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LYDSY/">LYDSY</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NOI/">NOI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SDOI/">SDOI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SHOI/">SHOI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TopCoder/">TopCoder</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UOJ/">UOJ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WC/">WC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ZJOI/">ZJOI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/总结/">总结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模板/">模板</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/清华集训/">清华集训</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/百度之星/">百度之星</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/省队集训/">省队集训</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/记录/">记录</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/酱油记/">酱油记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/集训队互测/">集训队互测</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/题解/">题解</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/51nod/" style="font-size: 16.25px;">51nod</a> <a href="/tags/APIO/" style="font-size: 12.5px;">APIO</a> <a href="/tags/AtCoder/" style="font-size: 10px;">AtCoder</a> <a href="/tags/CTSC/" style="font-size: 11.25px;">CTSC</a> <a href="/tags/Codechef/" style="font-size: 10px;">Codechef</a> <a href="/tags/Codeforces/" style="font-size: 15px;">Codeforces</a> <a href="/tags/FJOI/" style="font-size: 12.5px;">FJOI</a> <a href="/tags/FJWC/" style="font-size: 10px;">FJWC</a> <a href="/tags/HNOI/" style="font-size: 10px;">HNOI</a> <a href="/tags/IOI/" style="font-size: 10px;">IOI</a> <a href="/tags/LYDSY/" style="font-size: 11.25px;">LYDSY</a> <a href="/tags/NOI/" style="font-size: 12.5px;">NOI</a> <a href="/tags/SDOI/" style="font-size: 10px;">SDOI</a> <a href="/tags/SHOI/" style="font-size: 10px;">SHOI</a> <a href="/tags/TopCoder/" style="font-size: 10px;">TopCoder</a> <a href="/tags/UOJ/" style="font-size: 13.75px;">UOJ</a> <a href="/tags/WC/" style="font-size: 10px;">WC</a> <a href="/tags/ZJOI/" style="font-size: 10px;">ZJOI</a> <a href="/tags/总结/" style="font-size: 17.5px;">总结</a> <a href="/tags/模板/" style="font-size: 10px;">模板</a> <a href="/tags/清华集训/" style="font-size: 11.25px;">清华集训</a> <a href="/tags/百度之星/" style="font-size: 10px;">百度之星</a> <a href="/tags/省队集训/" style="font-size: 11.25px;">省队集训</a> <a href="/tags/记录/" style="font-size: 11.25px;">记录</a> <a href="/tags/酱油记/" style="font-size: 20px;">酱油记</a> <a href="/tags/集训队互测/" style="font-size: 10px;">集训队互测</a> <a href="/tags/题解/" style="font-size: 18.75px;">题解</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/12/04/lydsy-3489/">LYDSY P3489 题解</a>
          </li>
        
          <li>
            <a href="/2017/10/29/codeforces-443/">Codeforces Round 443 总结</a>
          </li>
        
          <li>
            <a href="/2017/10/22/astar2017/">百度之星Astar决赛被虐记</a>
          </li>
        
          <li>
            <a href="/2017/10/15/codeforces-440/">Codeforces Round 440 总结</a>
          </li>
        
          <li>
            <a href="/2017/10/09/atcoder-codefestival2017-qualb/">AtCoder CODE FESTIVAL 2017 qual B 总结</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 j324h9<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="//cdn.bootcss.com/mathjax/2.6.0/MathJax.js?config=TeX-AMS_HTML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>